# LLMプロンプト使用分析 - マーケティングインタビューシステム

## 📋 概要

このドキュメントでは、マーケティングインタビューシステムの各フェーズで使用されるLLMプロンプトの詳細と、商品・サービス情報および競合情報がどの段階でどのように活用されるかを説明します。

## 🚀 システムフロー と プロンプト使用概要

### フェーズ0: プロジェクト情報入力
- **LLM使用**: なし
- **ユーザー入力内容**:
  - 複数の商品・サービス情報（名前、ターゲット顧客、ベネフィット、根拠、基本情報）
  - 競合商品情報（名前、説明、価格、特徴）
  - トピック設定

---

## 🎭 フェーズ1: ペルソナ生成

### プロンプト種類: `persona_prompt`
### LLMモデル: `models/gemini-2.5-flash`

### 📝 入力情報の活用

**商品・サービス情報の使用方法**:
```
【対象商品・サービス情報】
商品・サービス名: {product.name}
ターゲット顧客: {product.target_audience}
ベネフィット: {product.benefits}
ベネフィットの根拠: {product.benefit_reason}
基本情報: {product.basic_info}
```

**競合情報の使用方法**:
```
【競合情報】
競合商品・サービス情報:
- {competitor.name}: {competitor.description} (価格: {competitor.price}) (特徴: {competitor.features})
```

### 🎯 プロンプト目的
- 商品・サービスのターゲット顧客層を考慮した多様なペルソナを5人生成
- 競合商品を知っている、または使用したことがあるペルソナも含める
- トピックに関連する多様な価値観を持つペルソナを作成

### 📤 出力形式
- 5人のペルソナ（名前、年齢、性別、職業、年収帯、居住地、家族構成、趣味・余暇、関心事・悩み）

---

## ❓ フェーズ3: 質問生成

### プロンプト種類: `question_prompt`
### LLMモデル: `models/gemini-2.5-flash`

### 📝 入力情報の活用

**商品・サービス情報の反映箇所**:
- ターゲット顧客の設定確認
- ベネフィットに対するニーズ・課題の深掘り
- 基本情報（価格など）に対する反応確認

**競合情報の反映箇所**:
- 競合商品・サービスの利用体験・満足度の質問
- 競合商品・サービスとの比較質問
- 競合の価格や特徴との比較評価

### 🎯 プロンプト目的
- 商品・サービス特化型の20個の質問リスト生成
- 競合比較を含む深掘り質問の作成

### 📋 質問カテゴリ
1. **基本情報・ライフスタイル**（3-4問）
2. **対象商品・サービスに対する現在の利用状況・認識**（4-5問）
3. **競合商品・サービスの利用体験・満足度**（3-4問）
4. **対象商品・サービスのベネフィットに関するニーズ・課題の深掘り**（4-5問）
5. **価格感・購入意向・将来への期待**（3-4問）

---

## 🗣️ フェーズ4-5: ペルソナセッション初期化

### プロンプト種類: `initial_prompt`
### LLMモデル: `models/gemini-2.5-flash`

### 📝 入力情報の活用

**商品・サービス情報の使用**:
```
【調査対象の商品・サービス情報】
調査対象商品・サービス: {product.name}
ターゲット: {product.target_audience}
ベネフィット: {product.benefits}
根拠: {product.benefit_reason}
基本情報: {product.basic_info}
```

**競合情報の使用**:
```
競合商品・サービス情報:
- {competitor.name}: {competitor.description} (価格: {competitor.price}) (特徴: {competitor.features})
```

### 🎯 プロンプト目的
- ペルソナになりきったチャットセッション初期化
- 商品・サービスや競合商品について質問された場合の現実的回答準備

---

## 📊 フェーズ6: 初回分析

### プロンプト種類: `analysis_prompt`
### LLMモデル: `models/gemini-2.5-flash`

### 📝 入力情報の活用

**商品・サービス情報の分析活用**:
- 対象商品・サービスに対する顧客インサイト抽出
- ターゲット顧客の検証
- ベネフィットの受容性評価
- 価格感・購入意向分析

**競合情報の分析活用**:
- 競合商品との比較分析
- 差別化ポイントの特定
- 競合に対する優位性・劣位性の評価

### 📋 分析レポート構成
1. **対象商品・サービスに対する顧客インサイト**
2. **競合商品との比較分析**
3. **ターゲット顧客の検証**
4. **ベネフィットの受容性**
5. **価格感・購入意向**
6. **マーケティングの示唆**

---

## 🔍 フェーズ7: 仮説生成・検証

### プロンプト種類: `hypothesis_prompt`, `follow_up_prompt`
### LLMモデル: `models/gemini-2.5-flash`

### 📝 仮説生成
- 初回分析結果を基にマーケティング仮説を構築
- 仮説検証のための追加質問を生成
- 商品・サービス特性と競合状況を考慮した戦略仮説

### 🎯 検証プロセス
- 各ペルソナとの仮説検証インタビュー
- 深掘り質問による洞察収集
- 商品・競合に関する具体的反応確認

---

## 🏆 フェーズ8: 最終分析

### プロンプト種類: `final_analysis_prompt`
### LLMモデル: `models/gemini-2.5-flash`

### 📝 入力情報の統合活用

**全情報統合**:
- 商品・サービス詳細情報
- 競合商品詳細情報
- 全ペルソナの初回+仮説検証インタビュー結果

### 🎯 最終戦略策定

**商品・サービス評価**:
- 市場適合性評価
- ターゲット顧客の精度確認
- ベネフィット訴求の効果測定

**競合分析統合**:
- 競合優位性の分析
- 差別化戦略の提案
- 市場ポジショニング戦略

### 📋 最終レポート構成
1. **商品・サービスの市場適合性**
2. **競合優位性の分析**
3. **ターゲット顧客の精度**
4. **ベネフィット訴求の効果**
5. **価格戦略の妥当性**
6. **推奨マーケティング戦略**
7. **リスクと課題**
8. **次のステップ**

---

## 🔄 商品・競合情報の使用フロー

### 📊 データフロー図

```
プロジェクト情報入力 (フェーズ0)
    ↓
    商品・サービス情報 (ProductService[])
    競合情報 (Competitor[])
    ↓
┌─────────────────────────────────────────┐
│ フェーズ1: ペルソナ生成                        │
│ • 商品ターゲット層考慮                         │
│ • 競合商品認知ペルソナ含む                      │
└─────────────────────────────────────────┘
    ↓
┌─────────────────────────────────────────┐
│ フェーズ3: 質問生成                           │
│ • 商品特化質問作成                            │
│ • 競合比較質問含む                            │
│ • ベネフィット検証質問                         │
└─────────────────────────────────────────┘
    ↓
┌─────────────────────────────────────────┐
│ フェーズ4-5: インタビュー実行                   │
│ • ペルソナに商品・競合情報を提供                │
│ • 文脈理解した現実的回答                       │
└─────────────────────────────────────────┘
    ↓
┌─────────────────────────────────────────┐
│ フェーズ6: 初回分析                           │
│ • 商品適合性分析                              │
│ • 競合比較分析                                │
│ • ターゲット検証                              │
└─────────────────────────────────────────┘
    ↓
┌─────────────────────────────────────────┐
│ フェーズ7: 仮説検証                           │
│ • 商品戦略仮説構築                            │
│ • 競合対策仮説検証                            │
└─────────────────────────────────────────┘
    ↓
┌─────────────────────────────────────────┐
│ フェーズ8: 最終戦略                           │
│ • 総合的市場戦略                              │
│ • 競合優位性戦略                              │
│ • 具体的アクションプラン                       │
└─────────────────────────────────────────┘
```

---

## 🎯 重要なプロンプト設計の特徴

### 1. **段階的情報活用**
- **初期**: 商品・競合情報をペルソナ生成に活用
- **中期**: インタビュー質問と回答に文脈として注入
- **後期**: 分析・戦略策定で統合的に活用

### 2. **商品情報の多面的活用**
- **ターゲット顧客**: ペルソナ生成の基準
- **ベネフィット**: 質問生成と受容性分析
- **基本情報（価格等）**: 購入意向・価格感分析
- **根拠**: 信頼性・説得力の評価

### 3. **競合情報の戦略的活用**
- **認知・利用経験**: ペルソナ設定とインタビュー質問
- **価格・特徴比較**: 差別化分析
- **市場ポジション**: 競合優位性戦略策定

### 4. **温度設定（Temperature）**
- **ペルソナ生成**: 0.8（創造性重視）
- **質問生成**: 0.7（適度な多様性）
- **要約**: 0.5（一貫性重視）
- **分析**: デフォルト（バランス重視）

---

## 💡 プロンプトエンジニアリングのポイント

### 1. **情報の段階的注入**
各フェーズで必要な情報のみを適切なタイミングで注入し、LLMの処理効率と精度を向上

### 2. **文脈の継続性**
前フェーズの結果を次フェーズのプロンプトに組み込み、一貫した分析フローを実現

### 3. **ロール設定の明確化**
各フェーズでLLMに適切な専門家ロール（マーケティング専門家、アナリスト、CMO等）を設定

### 4. **出力形式の統制**
厳密な出力形式指定により、後続処理での解析精度を向上

---

## 🔧 技術実装詳細

### プロンプト生成関数
```python
def generate_text(prompt, model_name="models/gemini-2.5-flash", temperature=0.8)
```

### 情報統合パターン
1. **プロジェクト情報取得**: `current_session.get("project_info")`
2. **商品情報フォーマット**: 各商品の詳細を構造化テキストに変換
3. **競合情報フォーマット**: 競合リストを比較可能な形式に整理
4. **文脈注入**: 各フェーズのプロンプトに適切な情報を組み込み

### エラーハンドリング
- LLM呼び出し失敗時の適切なエラーメッセージ
- 不完全な入力情報に対する代替処理
- タイムアウト対応とリトライ機能

---

## 📈 プロンプト効果の最大化

### 1. **情報の粒度調整**
- 各フェーズで必要な情報レベルに合わせた詳細度調整
- 過度な情報提供による混乱回避

### 2. **質問の戦略的設計**
- 商品特性を考慮した具体的質問生成
- 競合との差別化を引き出す質問設計

### 3. **分析の多角度アプローチ**
- 市場適合性、競合優位性、ターゲット精度等の多面的評価
- 戦略的示唆の具体性向上

---

このシステムでは、ユーザーが入力した商品・サービス情報と競合情報が全フェーズを通じて一貫して活用され、より精密で実用的なマーケティング分析を実現しています。
